# 设计说明

## 准备工作 (一) : 技术选型

一切的一切 , 都要从技术选型开始 , 技术选型跟项目类型直接挂钩 , 技术选型没有绝对 , 影响的因素有很多 , 所以这里只提供建议 , 以及本项目所使用的情况

**1. 是选择前后端分离, 还是选择前后端不分离?**

我个人对这一点比较在乎 , 无论什么项目我都会选择使用前后端分离 , 本项目也不例外 . 分离来解耦能够避免一些问题的发生 , 同时你的项目应该精益求精 , 专业的后端代码和专业的前端代码

如果项目目标不明确 , 会一直不断扩展 , 我建议使用前后端分离 , 如果项目比较明确 , 只是自己或者公司内部人员用 , 那分离或不分离只看个人想法了

**2. 是选择自带后台的框架, 还是不带后台的框架? 如果不带后台, 怎么解决数据CRUD问题** 

后台是一个很重要的功能 , 不管是你自己进行接口测试 , 还是对数据操作 , 都是非常高效且安全的功能

自带后台类的框架, 比如 `Django`  , 不可否认在数据管理这块得天独厚 , 但是他的灵活性会大打折扣 , 并且后台功能很多时候是冗余的 , 其次接口对接也是个麻烦事 :

1. 自带后台的框架 , 基本都有固定的开发规则 , 毕竟后台就是一个网站 , 即使框架本身给你预留了很多可扩展的地方 , 那也不是一件好事 , 房子还是自己的好
2. 你的项目大多数时候需要开发一个后台 , 框架自带的后台只不过是开发人员在用 , 这样就会导致你需要写两套数据操作的接口
3. 在进行接口对接的时候 , 你需要自己写接口文档供对接使用 , 还需要配合测试

个人比较喜欢灵活型的 , 功能不冗余的 , 所以本项目选择不带后台的

那选择不带后台的框架 , 该怎么提高接口测试以及数据管理效率 , 答案是使用 `Swagger` 这种在线接口文档 , 既提供了 `Postman` 这种工具 , 又可根据接口自动生成 , 网上有一些现成的 , 你也可以自己写 , 例如本脚手架中的 `docs` 就是我写的关于接口文档的代码 , 前后端总代码不超过1000行

**3. 性能选择**

注意 : `Tornado` 提高并发的方式只是提高吞吐量以及CPU利用率 , 并发数越大 , 性能优势越明显 ; 所以 , 如果并发数很小 , 且IO密集的情况下 , 可能还不如同步框架 , 如果是CPU密集 , 那可能 `Tornado` 要高于其他同步框架 (因为CPU利用率更高) , 这个有待测试研究

 ## 准备工作 (二) : 结构构思

项目结构越清晰 , 维护起来也会越方便 , 如果不好好规划 , 后期随着项目不断扩大 , 你的项目会一团糟

以 `Django` 的项目结构为例 :

1. `Django` 遵循以 APP 来划分 , 其次每个 APP 下面有自己的 `models.py` , `views.py` 等等 , 其中 `models.py` 的分类非常突出 , 通常来讲 , 你的项目大概率不同的 APP 中的 `models.py` 会交叉使用 , 结果就是这种 `Model` 的分类会随着交叉增多导致歧义越来越多 , 也越来越不好分类 , 所以 `views.py` 和 `models.py` 不该捆绑在一起 , 而是用各自的分类方式来进行 : `views.py` 也就是接口的分类方式应该是对外的 , 也就是说根据对外的功能进行划分 , `models.py` 的分类方式应该按照数据流动方式划分 , 总之就是 `models.py` 应该是脱离 `views.py` 的 , 而 `views.py` 则是依赖 `models.py` 
2. `Django` 的 APP 在后期调整很不方便 , 且一个功能开始之初 , 你无法掌握粒度 , 功能太大应该划分更细 ; 功能过小 , 在不需要预留的情况可以融合到一起

以上两点是最为突出的 , 其他的划分方式基本上不是很影响灵活性

总而言之 , 你的项目结构应该让人一眼就能知道整体情况

```
project
├── api             所有跟接口相关
├── apps            所有跟Model相关
├── base            跟框架有关的封装, 包括异常、配置、数据库等
├── deploy          部署相关配置
├── docs            API文档相关
├── lib             标准库相关(对标准库加工, 异常与易用性)
├── script          项目相关脚本
├── utils           工具包
├── build.py        打包加密脚本
├── config.py       配置文件
├── manage.py       数据库迁移相关
└── run.py          项目启动文件
```

## 脚手架开始 (一) : 环境分类

项目会有多个环境 , 这是必然的 , 我们不可能通过改配置的方式来切换环境 , 所以应该通过一个开关来控制

在项目启动之前 , 开关就已经确定好了 , 所以在项目的启动文件来制作开关是最好的选择

开关对应的配置可以是任何东西 , 比如 `.ini` , `.conf` 等等 , 更多我们是使用 `Class` 来定义 , 如本项目中的 `config.py` 

## 脚手架开始 (二) : 加载顺序

这是整个脚手架中最重要的一环 , 等我慢慢想想这篇文章该怎么写好一点……





